<p>As I’m sure almost every web developer/hacker knows, <a href="http://www.fiddler2.com/fiddler2/" target="_blank">Fiddler</a> is your best friend. One of Fiddler’s best features is that you can customize it very easily using a script file written in JScript. JScript is just a merging of .NET and JavaScript, very similar to ActionScript in fact. Being as I use Fiddler tons at work on my own projects, over time I’ve created scripts that I use day in and day out. I’ve decided to share them one blog post a day with the world.</p>  <p>To start with, we have my <em>ValidUrlOrHostName</em> method. This method is used by almost all my scripts to allow you to set that they only apply to some sessions. It checks of the given session matches:</p>  <ol><li>A given domain and, if wanted, it’s sub domains. </li>    <li>A regular expression of a URL </li>    <li>An exact URL </li> </ol><p>Domain matches must start with an <a href="mailto:%E2%80%98@%E2%80%99" target="_blank">‘@’</a>, and to include subdomains just prefix the domain with ‘*.’. To make a URL match via regular expression just start and end the URL with ‘/’.</p>  <pre style="border-bottom: #cecece 1px solid; border-left: #cecece 1px solid; padding-bottom: 5px; background-color: #fbfbfb; min-height: 40px; padding-left: 5px; width: 650px; padding-right: 5px; overflow: auto; border-top: #cecece 1px solid; border-right: #cecece 1px solid; padding-top: 5px"><pre style="background-color: #fbfbfb; margin: 0em; width: 100%; font-family: consolas,'Courier New',courier,monospace; font-size: 12px">  1: <span style="color: #0000ff">static</span> <span style="color: #0000ff">function</span> ValidUrlOrHostname(sWantedUrlsOrHostNames: String, oSession: Session) {<br /></pre><pre style="background-color: #fbfbfb; margin: 0em; width: 100%; font-family: consolas,'Courier New',courier,monospace; font-size: 12px">  2:         <span style="color: #0000ff">if</span> (sWantedUrlsOrHostNames.Length == 0) { <span style="color: #008000">// check if we need to check the anything</span><br /></pre><pre style="background-color: #fbfbfb; margin: 0em; width: 100%; font-family: consolas,'Courier New',courier,monospace; font-size: 12px">  3:             <span style="color: #0000ff">return</span> <span style="color: #0000ff">true</span><br /></pre><pre style="background-color: #fbfbfb; margin: 0em; width: 100%; font-family: consolas,'Courier New',courier,monospace; font-size: 12px">  4:         }<br /></pre><pre style="background-color: #fbfbfb; margin: 0em; width: 100%; font-family: consolas,'Courier New',courier,monospace; font-size: 12px">  5:         <br /></pre><pre style="background-color: #fbfbfb; margin: 0em; width: 100%; font-family: consolas,'Courier New',courier,monospace; font-size: 12px">  6:         <span style="color: #0000ff">var</span> oWantedUrlsOrHostNames: Array = sWantedUrlsOrHostNames.Split("<span style="color: #8b0000">,</span>"); <span style="color: #008000">// Split the wanted list (is CSL)</span><br /></pre><pre style="background-color: #fbfbfb; margin: 0em; width: 100%; font-family: consolas,'Courier New',courier,monospace; font-size: 12px">  7:         <span style="color: #0000ff">var</span> sCurrentHostNameParts: Array = oSession.hostname.Split("<span style="color: #8b0000">.</span>"); <span style="color: #008000">// Split the current hostname into it's parts</span><br /></pre><pre style="background-color: #fbfbfb; margin: 0em; width: 100%; font-family: consolas,'Courier New',courier,monospace; font-size: 12px">  8:         <br /></pre><pre style="background-color: #fbfbfb; margin: 0em; width: 100%; font-family: consolas,'Courier New',courier,monospace; font-size: 12px">  9:         <span style="color: #0000ff">for</span>(<span style="color: #0000ff">var</span> nMatchIndex = 0; nMatchIndex // Go through each match and test it<br /></pre><pre style="background-color: #fbfbfb; margin: 0em; width: 100%; font-family: consolas,'Courier New',courier,monospace; font-size: 12px"> 10:             <span style="color: #0000ff">var</span> sCurrentMatch: String = oWantedUrlsOrHostNames[nMatchIndex];<br /></pre><pre style="background-color: #fbfbfb; margin: 0em; width: 100%; font-family: consolas,'Courier New',courier,monospace; font-size: 12px"> 11:             <span style="color: #0000ff">if</span> (sCurrentMatch.StartsWith("<span style="color: #8b0000">@</span>")) { <span style="color: #008000">// Hostname</span><br /></pre><pre style="background-color: #fbfbfb; margin: 0em; width: 100%; font-family: consolas,'Courier New',courier,monospace; font-size: 12px"> 12:                 <span style="color: #0000ff">var</span> sReplaceHostNameParts: Array = sCurrentMatch.Substring(1).Split("<span style="color: #8b0000">.</span>"); <span style="color: #008000">// Split the current replace host</span><br /></pre><pre style="background-color: #fbfbfb; margin: 0em; width: 100%; font-family: consolas,'Courier New',courier,monospace; font-size: 12px"> 13:                 <span style="color: #0000ff">if</span> (sReplaceHostNameParts[0] != "<span style="color: #8b0000">*</span>") { <span style="color: #008000">// If the first part of the match hostname is not a '*' then we can just check for an exact match</span><br /></pre><pre style="background-color: #fbfbfb; margin: 0em; width: 100%; font-family: consolas,'Courier New',courier,monospace; font-size: 12px"> 14:                     <span style="color: #0000ff">if</span> (oSession.hostname == sCurrentMatch.Substring(1)) {<br /></pre><pre style="background-color: #fbfbfb; margin: 0em; width: 100%; font-family: consolas,'Courier New',courier,monospace; font-size: 12px"> 15:                         <span style="color: #0000ff">return</span> <span style="color: #0000ff">true</span>;<br /></pre><pre style="background-color: #fbfbfb; margin: 0em; width: 100%; font-family: consolas,'Courier New',courier,monospace; font-size: 12px"> 16:                     }<br /></pre><pre style="background-color: #fbfbfb; margin: 0em; width: 100%; font-family: consolas,'Courier New',courier,monospace; font-size: 12px"> 17:                     <span style="color: #0000ff">else</span> {<br /></pre><pre style="background-color: #fbfbfb; margin: 0em; width: 100%; font-family: consolas,'Courier New',courier,monospace; font-size: 12px"> 18:                         <span style="color: #0000ff">continue</span>;<br /></pre><pre style="background-color: #fbfbfb; margin: 0em; width: 100%; font-family: consolas,'Courier New',courier,monospace; font-size: 12px"> 19:                     }<br /></pre><pre style="background-color: #fbfbfb; margin: 0em; width: 100%; font-family: consolas,'Courier New',courier,monospace; font-size: 12px"> 20:                 }<br /></pre><pre style="background-color: #fbfbfb; margin: 0em; width: 100%; font-family: consolas,'Courier New',courier,monospace; font-size: 12px"> 21:                 <span style="color: #0000ff">for</span>(<span style="color: #0000ff">var</span> nHostPart = 1; (nHostPart // Go throught the parts of the hostnames backward <br /></pre><pre style="background-color: #fbfbfb; margin: 0em; width: 100%; font-family: consolas,'Courier New',courier,monospace; font-size: 12px"> 22:                     <span style="color: #0000ff">if</span> (sCurrentHostNameParts[sCurrentHostNameParts.Length - nHostPart] != sReplaceHostNameParts[sReplaceHostNameParts.Length - nHostPart]) {<br /></pre><pre style="background-color: #fbfbfb; margin: 0em; width: 100%; font-family: consolas,'Courier New',courier,monospace; font-size: 12px"> 23:                         <span style="color: #0000ff">if</span> (sReplaceHostNameParts[sReplaceHostNameParts.Length - nHostPart] == "<span style="color: #8b0000">*</span>") { <span style="color: #008000">// If they don't match but the match hostname part is '*' then we're good</span><br /></pre><pre style="background-color: #fbfbfb; margin: 0em; width: 100%; font-family: consolas,'Courier New',courier,monospace; font-size: 12px"> 24:                             <span style="color: #0000ff">return</span> <span style="color: #0000ff">true</span>;<br /></pre><pre style="background-color: #fbfbfb; margin: 0em; width: 100%; font-family: consolas,'Courier New',courier,monospace; font-size: 12px"> 25:                         }<br /></pre><pre style="background-color: #fbfbfb; margin: 0em; width: 100%; font-family: consolas,'Courier New',courier,monospace; font-size: 12px"> 26:                         <span style="color: #0000ff">break</span>;<br /></pre><pre style="background-color: #fbfbfb; margin: 0em; width: 100%; font-family: consolas,'Courier New',courier,monospace; font-size: 12px"> 27:                     }<br /></pre><pre style="background-color: #fbfbfb; margin: 0em; width: 100%; font-family: consolas,'Courier New',courier,monospace; font-size: 12px"> 28:                 }<br /></pre><pre style="background-color: #fbfbfb; margin: 0em; width: 100%; font-family: consolas,'Courier New',courier,monospace; font-size: 12px"> 29:                 <span style="color: #0000ff">if</span> (((nHostPart == sCurrentHostNameParts.Length) || (nHostPart == sReplaceHostNameParts.Length)) &amp;&amp; (sCurrentHostNameParts.Length // if we've check all we can it could still be a match<br /></pre><pre style="background-color: #fbfbfb; margin: 0em; width: 100%; font-family: consolas,'Courier New',courier,monospace; font-size: 12px"> 30:                     <span style="color: #0000ff">if</span> (sReplaceHostNameParts[0] == "<span style="color: #8b0000">*</span>") { <span style="color: #008000">// If the match hostname starts with a '*' then we're good!</span><br /></pre><pre style="background-color: #fbfbfb; margin: 0em; width: 100%; font-family: consolas,'Courier New',courier,monospace; font-size: 12px"> 31:                         <span style="color: #0000ff">return</span> <span style="color: #0000ff">true</span>;<br /></pre><pre style="background-color: #fbfbfb; margin: 0em; width: 100%; font-family: consolas,'Courier New',courier,monospace; font-size: 12px"> 32:                     }<br /></pre><pre style="background-color: #fbfbfb; margin: 0em; width: 100%; font-family: consolas,'Courier New',courier,monospace; font-size: 12px"> 33:                 }<br /></pre><pre style="background-color: #fbfbfb; margin: 0em; width: 100%; font-family: consolas,'Courier New',courier,monospace; font-size: 12px"> 34:             }<br /></pre><pre style="background-color: #fbfbfb; margin: 0em; width: 100%; font-family: consolas,'Courier New',courier,monospace; font-size: 12px"> 35:             <span style="color: #0000ff">else</span> <span style="color: #0000ff">if</span> (sCurrentMatch.StartsWith("<span style="color: #8b0000">/</span>") &amp;&amp; sCurrentMatch.EndsWith("<span style="color: #8b0000">/</span>")) { <span style="color: #008000">// URL Regex</span><br /></pre><pre style="background-color: #fbfbfb; margin: 0em; width: 100%; font-family: consolas,'Courier New',courier,monospace; font-size: 12px"> 36:                 <span style="color: #0000ff">var</span> urlRegex: Regex = <span style="color: #0000ff">new</span> Regex(sCurrentMatch.Substring(1, sCurrentMatch.Length - 2));<br /></pre><pre style="background-color: #fbfbfb; margin: 0em; width: 100%; font-family: consolas,'Courier New',courier,monospace; font-size: 12px"> 37:                 <span style="color: #0000ff">if</span> (urlRegex.IsMatch(oSession.url)) {<br /></pre><pre style="background-color: #fbfbfb; margin: 0em; width: 100%; font-family: consolas,'Courier New',courier,monospace; font-size: 12px"> 38:                     <span style="color: #0000ff">return</span> <span style="color: #0000ff">true</span>;<br /></pre><pre style="background-color: #fbfbfb; margin: 0em; width: 100%; font-family: consolas,'Courier New',courier,monospace; font-size: 12px"> 39:                 }<br /></pre><pre style="background-color: #fbfbfb; margin: 0em; width: 100%; font-family: consolas,'Courier New',courier,monospace; font-size: 12px"> 40:             }<br /></pre><pre style="background-color: #fbfbfb; margin: 0em; width: 100%; font-family: consolas,'Courier New',courier,monospace; font-size: 12px"> 41:             <span style="color: #0000ff">else</span> { <span style="color: #008000">// URL Exact</span><br /></pre><pre style="background-color: #fbfbfb; margin: 0em; width: 100%; font-family: consolas,'Courier New',courier,monospace; font-size: 12px"> 42:                 <span style="color: #0000ff">if</span> (sCurrentMatch == oSession.url) {<br /></pre><pre style="background-color: #fbfbfb; margin: 0em; width: 100%; font-family: consolas,'Courier New',courier,monospace; font-size: 12px"> 43:                     <span style="color: #0000ff">return</span> <span style="color: #0000ff">true</span>;<br /></pre><pre style="background-color: #fbfbfb; margin: 0em; width: 100%; font-family: consolas,'Courier New',courier,monospace; font-size: 12px"> 44:                 }<br /></pre><pre style="background-color: #fbfbfb; margin: 0em; width: 100%; font-family: consolas,'Courier New',courier,monospace; font-size: 12px"> 45:             }    <br /></pre><pre style="background-color: #fbfbfb; margin: 0em; width: 100%; font-family: consolas,'Courier New',courier,monospace; font-size: 12px"> 46:         }<br /></pre><pre style="background-color: #fbfbfb; margin: 0em; width: 100%; font-family: consolas,'Courier New',courier,monospace; font-size: 12px"> 47:         <span style="color: #0000ff">return</span> <span style="color: #0000ff">false</span>;<br /></pre><pre style="background-color: #fbfbfb; margin: 0em; width: 100%; font-family: consolas,'Courier New',courier,monospace; font-size: 12px"> 48:     }</pre></pre>